name: Dependency Security Check
on: [push, pull_request]

env:
    GITHUB_USERNAME: github-actions
    GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}

jobs:
    check-dependencies:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v4

            - name: Setup .NET 8
              uses: actions/setup-dotnet@v4
              with:
                  dotnet-version: 8.0.x

            - name: Authenticate GitHub Packages
              run: |
                  dotnet nuget add source "https://nuget.pkg.github.com/Sundy-Studios/index.json" \
                    --name github \
                    --username github-actions \
                    --password ${{ secrets.GITHUB_TOKEN }} \
                    --store-password-in-clear-text

            - name: Restore dependencies
              run: dotnet restore

            - name: Check for vulnerable packages
              run: dotnet list package --vulnerable
